/*!
 * depd
<<<<<<< HEAD
 * Copyright(c) 2014 Douglas Christopher Wilson
 * MIT Licensed
 */

/**
 * Module exports.
 */

lazyProperty(module.exports, 'bufferConcat', function bufferConcat() {
  return Buffer.concat || require('./buffer-concat')
})

lazyProperty(module.exports, 'callSiteToString', function callSiteToString() {
=======
 * Copyright(c) 2014-2015 Douglas Christopher Wilson
 * MIT Licensed
 */

'use strict'

/**
 * Module dependencies.
 * @private
 */

var EventEmitter = require('events').EventEmitter

/**
 * Module exports.
 * @public
 */

lazyProperty(module.exports, 'callSiteToString', function callSiteToString () {
>>>>>>> 8008b9e091b310b4513cd5a0add2883eeaa576ad
  var limit = Error.stackTraceLimit
  var obj = {}
  var prep = Error.prepareStackTrace

<<<<<<< HEAD
  function prepareObjectStackTrace(obj, stack) {
=======
  function prepareObjectStackTrace (obj, stack) {
>>>>>>> 8008b9e091b310b4513cd5a0add2883eeaa576ad
    return stack
  }

  Error.prepareStackTrace = prepareObjectStackTrace
  Error.stackTraceLimit = 2

  // capture the stack
  Error.captureStackTrace(obj)

  // slice the stack
  var stack = obj.stack.slice()

  Error.prepareStackTrace = prep
  Error.stackTraceLimit = limit

  return stack[0].toString ? toString : require('./callsite-tostring')
})

<<<<<<< HEAD
=======
lazyProperty(module.exports, 'eventListenerCount', function eventListenerCount () {
  return EventEmitter.listenerCount || require('./event-listener-count')
})

>>>>>>> 8008b9e091b310b4513cd5a0add2883eeaa576ad
/**
 * Define a lazy property.
 */

<<<<<<< HEAD
function lazyProperty(obj, prop, getter) {
  function get() {
=======
function lazyProperty (obj, prop, getter) {
  function get () {
>>>>>>> 8008b9e091b310b4513cd5a0add2883eeaa576ad
    var val = getter()

    Object.defineProperty(obj, prop, {
      configurable: true,
      enumerable: true,
      value: val
    })

    return val
  }

  Object.defineProperty(obj, prop, {
    configurable: true,
    enumerable: true,
    get: get
  })
}

/**
 * Call toString() on the obj
 */

<<<<<<< HEAD
function toString(obj) {
=======
function toString (obj) {
>>>>>>> 8008b9e091b310b4513cd5a0add2883eeaa576ad
  return obj.toString()
}
